<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-overview/server-discovery">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Build Server Discovery | Build Server Protocol</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://build-server-protocol.github.io/img/bsp-logo.svg"><meta data-rh="true" name="twitter:image" content="https://build-server-protocol.github.io/img/bsp-logo.svg"><meta data-rh="true" property="og:url" content="https://build-server-protocol.github.io/docs/overview/server-discovery"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Build Server Discovery | Build Server Protocol"><meta data-rh="true" name="description" content="The Build Server Protocol defines a standard convention for clients to connect"><meta data-rh="true" property="og:description" content="The Build Server Protocol defines a standard convention for clients to connect"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://build-server-protocol.github.io/docs/overview/server-discovery"><link data-rh="true" rel="alternate" href="https://build-server-protocol.github.io/docs/overview/server-discovery" hreflang="en"><link data-rh="true" rel="alternate" href="https://build-server-protocol.github.io/docs/overview/server-discovery" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://AL7XHCGLS5-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Build Server Protocol" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.e1f89c39.css">
<link rel="preload" href="/assets/js/runtime~main.0f641063.js" as="script">
<link rel="preload" href="/assets/js/main.95648376.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/bsp-logo.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/bsp-logo.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Build Server Protocol</b></a><a class="navbar__item navbar__link" href="/docs/specification">Specification</a><a href="https://github.com/build-server-protocol/build-server-protocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/specification">Specification</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/overview/faq">Overview</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/faq">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview/implementations">Implementations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/overview/server-discovery">Build Server Discovery</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/extensions/cpp">Extensions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/bindings/java">Bindings</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Overview</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Build Server Discovery</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Build Server Discovery</h1></header><p>The Build Server Protocol defines a standard convention for clients to connect
to BSP servers. This protocol has been designed such that:</p><ol><li>Clients do not require beforehand knowledge about a specific build tool to be
able to connect to its server.</li><li>Clients can connect to build tools installed at the machine and at the
workspace level.</li><li>Multiple build tools can run in the same workspace directory.</li><li>Multiple connections to a single build tool can run in the same workspace directory (as long as the build scopes for
each of the connections do not overlap).</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-bsp-connection-details">The BSP Connection Details<a href="#the-bsp-connection-details" class="hash-link" aria-label="Direct link to The BSP Connection Details" title="Direct link to The BSP Connection Details">​</a></h2><p>The following JSON object defines the BSP connection details:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">BspConnectionDetails</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** The name of the build tool. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** The version of the build tool. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  version</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** The bsp version of the build tool. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  bspVersion</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** A collection of languages supported by this BSP server. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  languages</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/** Command arguments runnable via system processes to start a BSP server */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  argv</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Every build tool supporting BSP must implement a build-tool-specific command to
generate the BSP connection details in one of the standard BSP locations for BSP
connection files.</p><p>BSP connection files:</p><ol><li>must be unique per build tool name, version and build scope to enable different versions
of the same build tool to select different BSP connection mechanisms.</li><li>multiple connection files for a single build tool name and version may co-exist in a single workspace root as long as
there is no overlap in their build scopes; this enables clients to request running separate builds within a single
workspace.</li><li>can be updated by the build tool at any point in time, including during the
startup of the build tool in a workspace.</li><li>can be added to version control if and only if they do not contain
machine-dependent information like absolute paths or workspace-specific data.</li></ol><p>This is an example of a BSP connection file:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;My Build Tool&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;version&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;21.3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;bspVersion&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2.0.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;languages&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;scala&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;javascript&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rust&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;argv&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my-build-tool&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bsp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-locations-for-bsp-connection-files">Default Locations for BSP Connection Files<a href="#default-locations-for-bsp-connection-files" class="hash-link" aria-label="Direct link to Default Locations for BSP Connection Files" title="Direct link to Default Locations for BSP Connection Files">​</a></h3><p>A BSP connection file can be located in a number of locations. BSP connection
files may be located in the project workspace, or for bsp servers installed
locally, in a system-wide or user-specific data directory, depending on the
operating system:</p><table><thead><tr><th></th><th>Unix + Mac</th><th>Windows</th></tr></thead><tbody><tr><td>Workspace</td><td><code>&lt;workspace-dir&gt;/.bsp/</code></td><td><code>&lt;workspace-dir&gt;\.bsp\</code></td></tr><tr><td>User</td><td><code>$XDG_DATA_HOME/bsp/</code></td><td><code>%LOCALAPPDATA%\bsp\</code></td></tr><tr><td></td><td><code>$HOME/Library/Application Support/bsp/</code> (Mac only)</td><td></td></tr><tr><td>System</td><td><code>$XDG_DATA_DIRS/bsp/</code></td><td><code>%PROGRAMDATA%\bsp\</code></td></tr><tr><td></td><td><code>/Library/Application Support/bsp/</code> (Mac only)</td><td></td></tr></tbody></table><p>Note that:</p><ol><li><code>&lt;workspace-dir&gt;</code> refers to the workspace base directory.</li><li><code>$XDG_DATA_HOME</code> and <code>$XDG_DATA_DIRS</code> are defined by the
<a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-0.6.html" target="_blank" rel="noopener noreferrer">XDG Base Directory Specification</a></li><li><code>%LOCALAPPDATA%</code> and <code>%PROGRAMDATA%</code> are defined by the
<a href="https://docs.microsoft.com/en-gb/windows/desktop/shell/csidl" target="_blank" rel="noopener noreferrer">Windows Documentation</a>
(see also:
<a href="https://docs.microsoft.com/en-gb/windows/desktop/shell/knownfolderid" target="_blank" rel="noopener noreferrer">Default Known Folders</a>)</li><li>on Macs, both standard macOS and Unix directories are supported</li></ol><p>The workspace location always has higher priority than the user or system
location, so if a client finds a BSP connection file that meets its criteria
inside a workspace location it must pick it over other BSP connection files in
the user or system location.</p><p>Workspace-defined build tools must not write BSP connection files to the user or
system locations. That location is only reserved for BSP connection files that
do not contain any workspace-specific data.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="policy-around-connection-files-generation">Policy around Connection Files Generation<a href="#policy-around-connection-files-generation" class="hash-link" aria-label="Direct link to Policy around Connection Files Generation" title="Direct link to Policy around Connection Files Generation">​</a></h3><p>To have a successful first-time connection to servers, at least one BSP
connection file must exist before users import a project in an IDE or invoke a
BSP client in a workspace.</p><p>Build tools installed globally by the user should write a BSP connection file to
the system location to minimize the chances that a client doesn&#x27;t discover it.
The BSP connection file should also be deleted when the build tool is
uninstalled.</p><p>However, in the more general case, build tools are required to implement a
command to generate a BSP connection file either in the user or system location.
This command must be runnable in the workspace base directory.</p><p>With such command, the following workflows become possible:</p><ol><li>Users can manually install a BSP connection file for any build tool.</li><li>Clients can implement smart discovery capabilities to:<ol><li>Detect the build tool(s) used in a workspace.</li><li>Invoke the command to generate a BSP connection file for them.</li></ol></li></ol><p>These workflows help improve the user experience for clients that want a more
out-of-the-box experience and provide a escape hatch for users to generate BSP
connection files for exotic and unsupported build tools.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-tool-commands-to-start-bsp-servers">Build Tool Commands to Start BSP Servers<a href="#build-tool-commands-to-start-bsp-servers" class="hash-link" aria-label="Direct link to Build Tool Commands to Start BSP Servers" title="Direct link to Build Tool Commands to Start BSP Servers">​</a></h3><p>The most important data field in the connection file is the <code>argv</code> JSON field.
The <code>argv</code> field contains the command arguments that start a BSP server via
system process.</p><p>Clients must meet the following requirements when using <code>argv</code> via system
process:</p><ol><li>The first element of the <code>argv</code> collection can be a simple name, a relative
path or an absolute path. A relative path is always relative to the workspace
base directory, so the client must prepend the value of the workspace folder
to the relative path before spawning <code>argv</code>.</li><li><code>argv</code> must always be invoked in the workspace base directory.</li><li><code>argv</code> must be invoked with the same environment variables of the client.</li></ol><p>Build tools must make sure that their <code>argv</code> invocation:</p><ol><li>Creates a fresh BSP connection to a server every time. This is required in
case there is more than one client connecting to a server or a server crashes
and a client wants to reconnect.</li><li>Uses <code>stdin</code> to send messages and <code>stdout</code> to receive responses to/from the
BSP server.</li><li>Uses <code>stderr</code> to report execution progress to the user.</li></ol><p>The use of <code>stdin</code> and <code>stdout</code> to communicate with the build server simplifies
the life of clients and allows build tools to implement their own underlying
protocol to connect to a local/remote build tool instance/daemon.</p><p>In addition, build tools can use the <code>argv</code> invocation for other purposes such
as:</p><ol><li>Spawn a daemon if it&#x27;s not already running.</li><li>Install the build tool if it&#x27;s not already installed in a user&#x27;s machine.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-with-my-build-tool">Example with <code>my-build-tool</code><a href="#example-with-my-build-tool" class="hash-link" aria-label="Direct link to example-with-my-build-tool" title="Direct link to example-with-my-build-tool">​</a></h4><p>To illustrate the responsibilities of the build tool, let&#x27;s go through a small
example where:</p><ol><li>The <code>my-build-tool</code> build tool is installed in the user&#x27;s machine.</li><li>The <code>argv</code> field is set to <code>[&quot;my-build-tool&quot;, &quot;bsp&quot;]</code>.</li><li>There is no running build tool instance in a workspace directory
<code>&lt;workspace&gt;</code>.</li><li><code>my-build-tool</code> supports BSP connections with a running instance of the build
tool via
<a href="https://en.wikipedia.org/wiki/Unix_domain_socket" target="_blank" rel="noopener noreferrer">UNIX domain sockets</a> and
<a href="https://docs.microsoft.com/en-us/windows/desktop/ipc/named-pipes" target="_blank" rel="noopener noreferrer">Windows Named Pipes</a>.</li></ol><p>The invocation of <code>my-build-tool bsp</code>, with current working directory
<code>&lt;workspace&gt;</code>, will need to:</p><ol><li>Run a background process of the build tool for the given <code>&lt;workspace&gt;</code>.</li><li>Pick the best way to connect to the running process depending on the machine
it runs. For example, it would use UNIX sockets in a Linux machine.</li><li>Fire up a BSP server in the build tool with script-specific connection
details. In the case of Unix sockets, the script will generate the socket
file and pass it to the background process of the build tool.</li><li>Connect to the running BSP server, forward anything that comes from <code>stdin</code>
to the BSP server and print anything that comes from the server&#x27;s output
streams to <code>stdout</code>. Execution progress will be shown in <code>stderr</code>.</li></ol><p>If the build tool is already running for a given project, the <code>argv</code> invocation
will only perform the last two steps.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clients-connecting-to-bsp-servers">Clients Connecting to BSP Servers<a href="#clients-connecting-to-bsp-servers" class="hash-link" aria-label="Direct link to Clients Connecting to BSP Servers" title="Direct link to Clients Connecting to BSP Servers">​</a></h2><p>The BSP Server Discovery aims to simplify clients the process of connecting to
servers.</p><p>Clients can connect to servers by locating connection files in the standard BSP
locations. BSP clients must look up connection files first in the bsp user
location and, only if the lookup of a connection file meeting certain criteria
fails, continue the search in the system location.</p><p>When more than a single BSP connection file is found, BSP clients can use connection
metadata to pick only the BSP servers they are interested in. If there are still
ambiguities, BSP clients are free to choose how to react, for example by asking
the end user to select a build server. Clients may also make it possible for the user to select
multiple connections, effectively having multiple, separate BSP builds running at one time.</p><p>When no BSP connection file is found (because, for example, the user has not run
the build tool command to generate BSP connection details), the BSP client can:</p><ol><li>Fail gracefully.</li><li>Ask users to type the command to generate the BSP connection details with
their preferred build tool and then connect to the BSP server.</li><li>Discover the build tool used in a project manually, run the command to
generate the BSP connection details and then connect to the BSP server.</li></ol><p>When BSP clients have found a valid connection file, they can connect to the
server by running the <code>argv</code> invocation via system process; listening to its
system output and writing to its system input. If the <code>argv</code> invocation fails,
the output in <code>stderr</code> must be shown to the user.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/build-server-protocol/build-server-protocol/edit/master/docs/overview/server-discovery.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/overview/implementations"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Implementations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/extensions/cpp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">cpp</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-bsp-connection-details" class="table-of-contents__link toc-highlight">The BSP Connection Details</a><ul><li><a href="#default-locations-for-bsp-connection-files" class="table-of-contents__link toc-highlight">Default Locations for BSP Connection Files</a></li><li><a href="#policy-around-connection-files-generation" class="table-of-contents__link toc-highlight">Policy around Connection Files Generation</a></li><li><a href="#build-tool-commands-to-start-bsp-servers" class="table-of-contents__link toc-highlight">Build Tool Commands to Start BSP Servers</a></li></ul></li><li><a href="#clients-connecting-to-bsp-servers" class="table-of-contents__link toc-highlight">Clients Connecting to BSP Servers</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Overview</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/specification">Specification</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/overview/implementations">Implementations</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/build-server-protocol/build-server-protocol" target="_blank">
                      <img src="https://img.shields.io/github/stars/build-server-protocol/build-server-protocol.svg?color=%23087e8b&label=stars&logo=github&style=social">
                    </a></li><li class="footer__item"><a href="https://discord.gg/7tMENrnv8p" target="_blank">
                      <img src="https://img.shields.io/discord/697002009336873011?logo=discord&style=social">
                    </a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/bsp-logo.svg" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/bsp-logo.svg" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright © 2023 Build Server Protocol</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0f641063.js"></script>
<script src="/assets/js/main.95648376.js"></script>
</body>
</html>