<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>JVM Extension · Build Server Protocol</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The following section contains JVM-specific extensions to the build server"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="JVM Extension · Build Server Protocol"/><meta property="og:type" content="website"/><meta property="og:url" content="https://build-server-protocol.github.io/build-server-protocol/index.html"/><meta property="og:description" content="The following section contains JVM-specific extensions to the build server"/><meta property="og:image" content="https://build-server-protocol.github.io/build-server-protocol/img/bsp-logo.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://build-server-protocol.github.io/build-server-protocol/img/bsp-logo.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/bsp-logo.svg" alt="Build Server Protocol"/><h2 class="headerTitleWithLogo">Build Server Protocol</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/specification.html" target="_self">Specification</a></li><li class=""><a href="https://github.com/build-server-protocol/build-server-protocol" target="_blank">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Extensions</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/specification.html">Specification</a></li><li class="navListItem"><a class="navItem" href="/docs/implementations.html">Implementations</a></li><li class="navListItem"><a class="navItem" href="/docs/server-discovery.html">Build Server Discovery</a></li><li class="navListItem"><a class="navItem" href="/docs/faq.html">Frequently Asked Questions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Extensions</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/extensions/jvm.html">JVM</a></li><li class="navListItem"><a class="navItem" href="/docs/extensions/scala.html">Scala</a></li><li class="navListItem"><a class="navItem" href="/docs/extensions/sbt.html">sbt</a></li><li class="navListItem"><a class="navItem" href="/docs/extensions/java.html">Java</a></li><li class="navListItem"><a class="navItem" href="/docs/extensions/maven.html">Maven</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Bindings</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/bindings/java.html">Java</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/build-server-protocol/build-server-protocol/edit/master/docs/extensions/jvm.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">JVM Extension</h1></header><article><div><span><p>The following section contains JVM-specific extensions to the build server
protocol.</p>
<h2><a class="anchor" aria-hidden="true" id="jvm-build-target"></a><a href="#jvm-build-target" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JVM Build Target</h2>
<p><code>JvmBuildTarget</code> is a basic data structure that contains jvm-specific
metadata, specifically JDK reference. This metadata is embedded in
the <code>data: Option[Json]</code> field of the <code>BuildTarget</code> definition, when
the <code>dataKind</code> field contains &quot;jvm&quot;.</p>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmBuildTarget {
  <span class="hljs-comment">/** Uri representing absolute path to jdk
   * For example: file:///usr/lib/jvm/java-8-openjdk-amd64 */</span>
  javaHome?: Uri;

  <span class="hljs-comment">/** The java version this target is supposed to use.
   * For example: 1.8 */</span>
  javaVersion?: <span class="hljs-built_in">String</span>;
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="test-environment-request"></a><a href="#test-environment-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Test Environment Request</h2>
<p>The JVM test environment request is sent from the client to the server in order to
gather information required to launch a Java process. This is useful when the
client wants to control the Java process execution, for example to enable custom
Java agents or launch a custom main class during unit testing or debugging</p>
<p>The data provided by this endpoint may change between compilations, so it should
not be cached in any form. The client should ask for it right before test execution,
after all the targets are compiled.</p>
<ul>
<li>method: <code>buildTarget/jvmTestEnvironment</code></li>
<li>params: <code>JvmTestEnvironmentParams</code></li>
</ul>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmTestEnvironmentParams(
    targets: BuildTargetIdentifier[],
    originId?: String
)
</code></pre>
<p>Response:</p>
<ul>
<li>result: <code>JvmTestEnvironmentResult</code>, defined as follows</li>
<li>error: JSON-RPC code and message set in case an exception happens during the
request.</li>
</ul>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmMainClass {
    <span class="hljs-keyword">class</span>: <span class="hljs-built_in">String</span>;
    <span class="hljs-built_in">arguments</span>: <span class="hljs-built_in">String</span>[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmEnvironmentItem{
    target: BuildTargetIdentifier;
    classpath: Uri[];
    jvmOptions: <span class="hljs-built_in">String</span>[];
    workingDirectory: <span class="hljs-built_in">String</span>;
    environmentVariables: Map&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">String</span>&gt;;
    mainClasses?: JvmMainClass[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmTestEnvironmentResult{
    items: JvmEnvironmentItem[];
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="run-environment-request"></a><a href="#run-environment-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run Environment Request</h2>
<p>Similar to <code>buildTarget/jvmTestEnvironment</code>, but returns environment
that should be used for regular exection of main classes, not for testing</p>
<ul>
<li>method: <code>buildTarget/jvmRunEnvironment</code></li>
<li>params: <code>JvmRunEnvironmentParams</code></li>
</ul>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmRunEnvironmentParams(
    targets: BuildTargetIdentifier[],
    originId?: String
)
</code></pre>
<p>Response:</p>
<ul>
<li>result: <code>JvmRunEnvironmentResult</code>, defined as follows</li>
<li>error: JSON-RPC code and message set in case an exception happens during the
request.</li>
</ul>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmMainClass {
    <span class="hljs-keyword">class</span>: <span class="hljs-built_in">String</span>;
    <span class="hljs-built_in">arguments</span>: <span class="hljs-built_in">String</span>[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmEnvironmentItem{
    target: BuildTargetIdentifier;
    classpath: Uri[];
    jvmOptions: <span class="hljs-built_in">String</span>[];
    workingDirectory: <span class="hljs-built_in">String</span>;
    environmentVariables: Map&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">String</span>&gt;;
    mainClasses?: JvmMainClass[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> JvmRunEnvironmentResult{
    items: JvmEnvironmentItem[];
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/faq.html"><span class="arrow-prev">← </span><span>Frequently Asked Questions</span></a><a class="docs-next button" href="/docs/extensions/scala.html"><span>Scala</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#jvm-build-target">JVM Build Target</a></li><li><a href="#test-environment-request">Test Environment Request</a></li><li><a href="#run-environment-request">Run Environment Request</a></li></ul></nav></div><footer class="nav-footer" id="footer" style="background-color:#555"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/bsp-logo.svg" alt="Build Server Protocol" width="66" height="58"/></a><div><h5>Overview</h5><a href="/docs/specification.html">Specification</a><a href="/docs/implementations.html">Implementations</a></div><div><h5>Social</h5><a href="https://github.com/build-server-protocol/build-server-protocol" target="_blank"><img src="https://img.shields.io/github/stars/scalacenter/bsp.svg?color=%23087e8b&amp;label=stars&amp;logo=github&amp;style=social"/></a><a href="https://discord.gg/7tMENrnv8p" target="_blank"><img src="https://badgen.net/badge/icon/discord?icon=discord&amp;label"/></a></div></section><section class="copyright">Copyright © 2023 Build Server Protocol</section><section class="copyright"><p>The Build Server Protocol is a collaborative effort between developers at the <a href="https://scala.epfl.ch/">Scala Center</a> and <a href="https://www.jetbrains.com/">Jetbrains</a>.</p></section></footer></div></body></html>